<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style.css">
    <script src="http://d3js.org/d3.v4.min.js" charset="utf-8"></script>
    <title>D3 js sample</title>
</head>
<body>
    <!-- <p id="1">34</p>
    <p id="2">56</p>
    <p id="3">23</p>
    <p id="4">78</p> -->
    <div class="top-card__graph">
        <p id="0">34</p>
    </div>
    <div class="top-card__graph" id="1">
        <p id="1">54</p>
    </div>
    <div class="top-card__graph">
        <p id="2">23</p>
    </div>
    <div class="top-card__graph">
        <p id="3">78</p>
    </div>


    <script type="text/javascript">

    function drawChart(num) {
        var data = [
      {count: 23, color: '#8bc34a'},
      {count: 77, color: '#424242'},
    ];
    var target = document.getElementById(num);
    console.log(target);
    var percent = target.textContent;
    percent = Number(percent);
    data[0].count = percent;
    var rest = 100 - percent;
    data[1].count = rest;
    var totalCount = 100; //this is static value
    document.getElementById(num).innerHTML = "";
    var width = 80,
    height = 80,
    radius = 25;

    var arc = d3.arc()
        .outerRadius(radius - 4)
        .innerRadius(35);

    var pie = d3.pie()
    .sort(null)
    .value(function(d) {
        console.log(d);
        return d.count;
    });

    var svg = d3.select('body').select('.top-card__graph').append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g")
        .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

    var g = svg.selectAll(".arc")
      .data(pie(data))
      .enter().append("g");    

   	g.append("path")
       .attr("d", arc)
       .style("fill", function(d,i) {
           return d.data.color;
        });
        
    g.append("text")
	   .attr("text-anchor", "middle")
		 .attr('font-size', '15px')
		 .attr('y', 8)
	   .text(percent + "%");
    }

    var graphTag = document.getElementsByClassName('top-card__graph');
    var count = graphTag.length;
    for (i = 0; i < count; i++) {
        drawChart(i);
    }
    </script>
</body>
</html>